<!DOCTYPE html>
<html lang="zh"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kitex-微服务-grpc框架(字节跳动开源)</title>
    <meta charset="utf-8">
    <meta name="description" content="Ladder@Kitex，字节跳动内部的 Go 微服务 RPC 框架 ，包括但不限于脚手架构建代码、日志、服务注册服务发现、中间件、负载均衡、限流、熔断、服务降级">
    <meta name="author" content="印象简单/EasyImpr">
    <link rel="canonical" href="http://localhost:1313/code/kitex/">

    <link rel="alternate" type="application/rss+xml" href="http://localhost:1313//index.xml" title="印象简单的博客">

    


    <meta property="og:url" content="http://localhost:1313/code/kitex/">
  <meta property="og:site_name" content="印象简单的博客">
  <meta property="og:title" content="kitex-微服务-grpc框架(字节跳动开源)">
  <meta property="og:description" content="Kitex，字节跳动内部的 Go 微服务 RPC 框架 ，包括但不限于脚手架构建代码、日志、服务注册服务发现、中间件、负载均衡、限流、熔断、服务降级">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="code">
    <meta property="article:published_time" content="2026-01-15T14:33:14+08:00">
    <meta property="article:modified_time" content="2026-01-15T14:33:14+08:00">
    <meta property="article:tag" content="Golang">
      <meta property="og:see_also" content="http://localhost:1313/code/grpc/">
      <meta property="og:see_also" content="http://localhost:1313/code/mongo/">
      <meta property="og:see_also" content="http://localhost:1313/agent/loopagent%E5%BE%AA%E7%8E%AF%E4%BC%98%E5%8C%96%E4%BB%A3%E7%A0%81/">
      <meta property="og:see_also" content="http://localhost:1313/agent/%E6%B5%81%E7%A8%8B%E7%9A%84%E4%B8%AD%E6%96%AD%E4%B8%8E%E5%9B%9E%E5%A4%8D/">
      <meta property="og:see_also" content="http://localhost:1313/agent/%E9%80%9A%E8%BF%87adk%E8%B0%83%E7%94%A8ai_agent%E4%BB%A5%E5%8F%8A%E5%8E%86%E5%8F%B2%E6%B6%88%E6%81%AF%E7%9A%84%E4%BF%9D%E5%AD%98/">
      <meta property="og:see_also" content="http://localhost:1313/agent/%E5%9C%A8eino%E9%87%8C%E8%B0%83%E7%94%A8mcp%E5%B7%A5%E5%85%B7/">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="kitex-微服务-grpc框架(字节跳动开源)">
  <meta name="twitter:description" content="Kitex，字节跳动内部的 Go 微服务 RPC 框架 ，包括但不限于脚手架构建代码、日志、服务注册服务发现、中间件、负载均衡、限流、熔断、服务降级">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Codes",
      "item": "http://localhost:1313/code/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "kitex-微服务-grpc框架(字节跳动开源)",
      "item": "http://localhost:1313/code/kitex/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "kitex-微服务-grpc框架(字节跳动开源)",
  "name": "kitex-微服务-grpc框架(字节跳动开源)",
  "description": "Kitex，字节跳动内部的 Go 微服务 RPC 框架 ，包括但不限于脚手架构建代码、日志、服务注册服务发现、中间件、负载均衡、限流、熔断、服务降级\n",
  "keywords": [
    "golang"
  ],
  "articleBody": "Kitex，字节跳动内部的 Go 微服务 RPC 框架 ，包括但不限于脚手架构建代码、日志、服务注册服务发现、中间件、负载均衡、限流、熔断、服务降级\nKitex Kitex[kaɪt’eks] 字节跳动内部的 Go 微服务 RPC 框架，具有高性能、强可扩展的特点，在字节内部已广泛使用。如果对微服务性能有要求，又希望定制扩展融入自己的治理体系，Kitex 会是一个不错的选择。\nkitex序列化工具 安装\ngo install github.com/cloudwego/kitex/tool/cmd/kitex@latest 在项目引入包\ngo get -u github.com/cloudwego/kitex my_kitex/idl/math.proto\nsyntax=\"proto3\"; package idl; // proto文件互相引用时需要指定package。不需要相互引用时，这一行可以不写 option go_package=\"math_service\"; //生成go文件后对应的package名 message AddRequest { int32 left = 1; int32 right = 2; } message AddResponse { int32 sum = 1; } message SubRequest { int32 left = 1; int32 right = 2; } message SubResponse { int32 diff = 1; } service Math { rpc Add(AddRequest) returns (AddResponse); rpc Sub(SubRequest) returns (SubResponse); } kitex -module myKitex idl/math.proto 会生成一个kitex_gen目录，import语句里需要用到module名称\nmath.pb.go是官方的pb工具生成的，math.pb.fast.go是字节自家的fastpb工具生成的，math.pb.fast.go是对math.pb.go的补充\n执行一下go mod tidy\nPS:Kitex的序列化和反序列化工具比默认grpc序列化反序列化快了很多\n服务脚手架代码 生成服务端代码 参数 作用 示例 kitex 工具名 - -module Go 模块名 myKitex -service 生成服务端代码(服务名称，任意字符串) easyimpr.math -use 引用已有的 kitex_gen myKitex/kitex_gen IDL文件 接口定义文件 ../idl/math.proto cd /my_kitex/server/ kitex -module myKitex -service easyimpr.math -use myKitex/kitex_gen ../idl/math.proto 接下来我们只需要就该server下面的handler.go实现具体的逻辑即可\n// Add implements the MathImpl interface. func (s *MathImpl) Add(ctx context.Context, req *math_service.AddRequest) (resp *math_service.AddResponse, err error) { // TODO: Your code here... resp = \u0026math_service.AddResponse{ Sum: req.Left + req.Right, } return resp, nil } // Sub implements the MathImpl interface. func (s *MathImpl) Sub(ctx context.Context, req *math_service.SubRequest) (resp *math_service.SubResponse, err error) { // TODO: Your code here... resp = \u0026math_service.SubResponse{ Diff: req.Left - req.Right, } return resp, nil } kitex还是很贴心的，连编译和运行的脚本都写好了，由于我是mac，没怎么用过windows，不知道windows是否能正常运行（好像是用wsl？）\n当然，我们不可能只用默认的8888端口号\n我们修改main.go\naddr, _ := net.ResolveTCPAddr(\"tcp\", \"127.0.0.1:5678\") svr := math_service.NewServer(new(MathImpl), server.WithServiceAddr(addr)) err := svr.Run() if err != nil { log.Println(err.Error()) } 完成客户端代码 cd ./my_kitex/client/ 新建main.go\nimport ( \"context\" \"fmt\" \"log\" \"myKitex/kitex_gen/math_service\" \"myKitex/kitex_gen/math_service/math\" \"github.com/cloudwego/kitex/client\" ) func main() { //这个函数是之前生成的脚手架代码中的函数，用于创建一个客户端，前面的是服务名称，后面的是地址 client, err := math.NewClient(\"easyimpr.math\", client.WithHostPorts(\"127.0.0.1:5678\")) if err != nil { log.Fatalf(\"failed to create client: %v\", err) } //定义请求参数 request := math_service.SubRequest{Left: 9, Right: 1} //调用方法 response, err := client.Sub(context.Background(), \u0026request) if err != nil { log.Fatalf(\"failed to call sub: %v\", err) } //打印结果 fmt.Println(response.Diff) } ",
  "wordCount" : "282",
  "inLanguage": "zh",
  "datePublished": "2026-01-15T14:33:14+08:00",
  "dateModified": "2026-01-15T14:33:14+08:00",
  "author":{
    "@type": "Person",
    "name": "印象简单/EasyImpr"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/code/kitex/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "印象简单的博客",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
    <link rel="icon" href="/images/%e5%be%ae%e4%bf%a1%e5%9b%be%e7%89%87_2025-11-23_104342_537.jpg" sizes="16x16">

<link rel="apple-touch-icon" href="/images/%e5%be%ae%e4%bf%a1%e5%9b%be%e7%89%87_2025-11-23_104342_537.jpg">

<link rel="manifest" href="/images/%e5%be%ae%e4%bf%a1%e5%9b%be%e7%89%87_2025-11-23_104342_537.jpg">
    

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css" />

    
    
    <link rel="stylesheet" href="/css/main.min.ec28f09e946fc0df77c187fcd0d0ebde58fca6de8efb8e1620f3d45c32d4da88.css" integrity="sha256-7CjwnpRvwN93wYf80NDr3lj8pt6O&#43;44WIPPUXDLU2og=" crossorigin="anonymous" media="screen" />

    
    <link rel="stylesheet" href="/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css" />

    
    <script src="/js/highlight.min.min.65a3017a8aabe1f9330e70527075c8d51bc9634d5cac35077af03588c1df8078.js"></script>
    <script>hljs.highlightAll();</script>

    <script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script>
    </head>
<body>
      <main class="wrapper"><nav class="navigation">
    <section class="container">
        <a class="navigation-brand" href="/">
            主页
        </a>
        <input type="checkbox" id="menu-toggle" />
        <label class="menu-button float-right" for="menu-toggle">
            <span></span><span></span><span></span>
        </label>
        
        <ul class="navigation-list" id="navigation-list">
            
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/code/">开发</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/agent/">Agent</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/life/">生活</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/friend/">友情链接</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/guestbook/">留言板</a>
            </li>
            
            

            <li class="navigation-item menu-separator">
                <span>|</span>
            </li>

            
            
            <li class="navigation-item navigation-social">
                <a class="navigation-link" href="https://github.com/yinxiangpingfan"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a>
            </li>
            
            <li class="navigation-item navigation-social">
                <a class="navigation-link" href="mailto:ecygbsj@163.com"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a>
            </li>
            
            

            <li class="navigation-item navigation-dark">
                <button id="mode" type="button" aria-label="toggle user light or dark theme">
                    <span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
                    <span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
                </button>
            </li>

            
            
        </ul>
        
    </section>
</nav>
<div id="content">
<article class="blog-single">
  <header class="blog-title">
    <h1>kitex-微服务-grpc框架(字节跳动开源)</h1>
  </header>

  <p>
  <small>
    2026年1月15日&nbsp;· 282 字&nbsp;· 2 分钟</small>

  
<p>

  <div class="blog-toc">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#kitex序列化工具">kitex序列化工具</a></li>
    <li><a href="#服务脚手架代码">服务脚手架代码</a>
      <ul>
        <li><a href="#生成服务端代码">生成服务端代码</a></li>
        <li><a href="#完成客户端代码">完成客户端代码</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>

  <section class="blog-content"><p>Kitex，字节跳动内部的 Go 微服务 RPC 框架 ，包括但不限于脚手架构建代码、日志、服务注册服务发现、中间件、负载均衡、限流、熔断、服务降级</p>
<h1 id="kitex">Kitex</h1>
<p>Kitex[kaɪt’eks] 字节跳动内部的 Go 微服务 RPC 框架，具有高性能、强可扩展的特点，在字节内部已广泛使用。如果对微服务性能有要求，又希望定制扩展融入自己的治理体系，Kitex 会是一个不错的选择。</p>
<h2 id="kitex序列化工具">kitex序列化工具</h2>
<p>安装</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>go install github.com/cloudwego/kitex/tool/cmd/kitex@latest
</span></span></code></pre></div><p>在项目引入包</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>go get -u github.com/cloudwego/kitex
</span></span></code></pre></div><p>my_kitex/idl/math.proto</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-proto" data-lang="proto"><span style="display:flex;"><span>syntax<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;proto3&#34;</span>;<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">package</span> idl;    <span style="color:#75715e">// proto文件互相引用时需要指定package。不需要相互引用时，这一行可以不写
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">option</span> go_package<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;math_service&#34;</span>;    <span style="color:#75715e">//生成go文件后对应的package名
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">AddRequest</span> {<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int32</span> left <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int32</span> right <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">AddResponse</span> {<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int32</span> sum <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">SubRequest</span> {<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int32</span> left <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int32</span> right <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">SubResponse</span> {<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int32</span> diff <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#66d9ef">service</span> Math {<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">rpc</span> Add(AddRequest) <span style="color:#66d9ef">returns</span> (AddResponse);<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">rpc</span> Sub(SubRequest) <span style="color:#66d9ef">returns</span> (SubResponse);<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kitex -module myKitex idl/math.proto
</span></span></code></pre></div><p>会生成一个kitex_gen目录，import语句里需要用到module名称</p>
<p>math.pb.go是官方的pb工具生成的，math.pb.fast.go是字节自家的fastpb工具生成的，math.pb.fast.go是对math.pb.go的补充</p>
<p>执行一下go mod tidy</p>
<p>PS:Kitex的序列化和反序列化工具比默认grpc序列化反序列化快了很多</p>
<h2 id="服务脚手架代码">服务脚手架代码</h2>
<h3 id="生成服务端代码">生成服务端代码</h3>
<table>
  <thead>
      <tr>
          <th>参数</th>
          <th>作用</th>
          <th>示例</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>kitex</td>
          <td>工具名</td>
          <td>-</td>
      </tr>
      <tr>
          <td>-module</td>
          <td>Go 模块名</td>
          <td>myKitex</td>
      </tr>
      <tr>
          <td>-service</td>
          <td>生成服务端代码(服务名称，任意字符串)</td>
          <td>easyimpr.math</td>
      </tr>
      <tr>
          <td>-use</td>
          <td>引用已有的 kitex_gen</td>
          <td>myKitex/kitex_gen</td>
      </tr>
      <tr>
          <td>IDL文件</td>
          <td>接口定义文件</td>
          <td>../idl/math.proto</td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cd /my_kitex/server/
</span></span><span style="display:flex;"><span>kitex -module myKitex -service easyimpr.math -use myKitex/kitex_gen  ../idl/math.proto
</span></span></code></pre></div><p>接下来我们只需要就该server下面的handler.go实现具体的逻辑即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Add implements the MathImpl interface.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">MathImpl</span>) <span style="color:#a6e22e">Add</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">req</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">math_service</span>.<span style="color:#a6e22e">AddRequest</span>) (<span style="color:#a6e22e">resp</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">math_service</span>.<span style="color:#a6e22e">AddResponse</span>, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// TODO: Your code here...</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">resp</span> = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">math_service</span>.<span style="color:#a6e22e">AddResponse</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Sum</span>: <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">Left</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">Right</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">resp</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Sub implements the MathImpl interface.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">MathImpl</span>) <span style="color:#a6e22e">Sub</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">req</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">math_service</span>.<span style="color:#a6e22e">SubRequest</span>) (<span style="color:#a6e22e">resp</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">math_service</span>.<span style="color:#a6e22e">SubResponse</span>, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// TODO: Your code here...</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">resp</span> = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">math_service</span>.<span style="color:#a6e22e">SubResponse</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Diff</span>: <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">Left</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">Right</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">resp</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>kitex还是很贴心的，连编译和运行的脚本都写好了，由于我是mac，没怎么用过windows，不知道windows是否能正常运行（好像是用wsl？）</p>
<p>当然，我们不可能只用默认的8888端口号</p>
<p>我们修改main.go</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>	<span style="color:#a6e22e">addr</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">ResolveTCPAddr</span>(<span style="color:#e6db74">&#34;tcp&#34;</span>, <span style="color:#e6db74">&#34;127.0.0.1:5678&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">svr</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">math_service</span>.<span style="color:#a6e22e">NewServer</span>(new(<span style="color:#a6e22e">MathImpl</span>), <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">WithServiceAddr</span>(<span style="color:#a6e22e">addr</span>))
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">svr</span>.<span style="color:#a6e22e">Run</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><h3 id="完成客户端代码">完成客户端代码</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cd ./my_kitex/client/
</span></span></code></pre></div><p>新建main.go</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;myKitex/kitex_gen/math_service&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;myKitex/kitex_gen/math_service/math&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;github.com/cloudwego/kitex/client&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//这个函数是之前生成的脚手架代码中的函数，用于创建一个客户端，前面的是服务名称，后面的是地址</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">math</span>.<span style="color:#a6e22e">NewClient</span>(<span style="color:#e6db74">&#34;easyimpr.math&#34;</span>, <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">WithHostPorts</span>(<span style="color:#e6db74">&#34;127.0.0.1:5678&#34;</span>))
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;failed to create client: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//定义请求参数</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">request</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">math_service</span>.<span style="color:#a6e22e">SubRequest</span>{<span style="color:#a6e22e">Left</span>: <span style="color:#ae81ff">9</span>, <span style="color:#a6e22e">Right</span>: <span style="color:#ae81ff">1</span>}
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//调用方法</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">response</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Sub</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(), <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">request</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;failed to call sub: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//打印结果</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">Diff</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section>

  
  

  

<div class="related-resources">
  
    
    
    
  
</div>


  
  
<div class="comments">
  <script>
      const getTheme = window.localStorage && window.localStorage.getItem("theme");
      let theme = getTheme === 'dark' ? 'dark' : 'light';
      let s = document.createElement('script');
      s.src = 'https://giscus.app/client.js';
      s.setAttribute('data-repo', 'yinxiangpingfan\/yinxiangpingfan.github.io');
      s.setAttribute('data-repo-id', 'R_kgDOQ3n2PQ');
      s.setAttribute('data-category', 'Announcements');
      s.setAttribute('data-category-id', 'DIC_kwDOQ3n2Pc4C0-Rs');
      s.setAttribute('data-mapping', 'pathname');
      s.setAttribute('data-strict', '0');
      s.setAttribute('data-reactions-enabled', '1');
      s.setAttribute('data-emit-metadata', '0');
      s.setAttribute('data-input-position', 'top');
      s.setAttribute('data-theme', theme);
      s.setAttribute('data-lang', 'zh-CN');
      s.setAttribute('data-loading', 'lazy');
      s.setAttribute('crossorigin', 'anonymous');
      s.setAttribute('async', '');
      document.querySelector('div.comments').innerHTML = '';
      document.querySelector('div.comments').appendChild(s);
  </script>
</div>

</article>

        </div><footer class="footer">
  <p>&copy; 2026 <a href="http://localhost:1313/">印象简单的博客</a>
    Powered by
    <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo️️</a>
    <a href="https://github.com/guangzhengli/hugo-theme-ladder" rel="noopener" target="_blank">Ladder</a>
️  </p>
</footer>

<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211C22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257M21.7387 7.71865C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257C17.1684 -1.24629 7.83127 0.632493 4.27577 5.04257C2.88063 6.77451 -0.0433281 11.1668 1.38159 16.6571C2.27481 20.0988 5.17269 22.2936 8.19743 22.7725M20.7188 5.04257C22.0697 6.9404 24.0299 11.3848 22.3541 15.4153M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814C11.1703 6.98257 11.0247 6.98456 10.9937 7.05061C10.5221 8.05496 9.07362 9.92941 8 10.945M11.0333 7.44444C10.9392 9.86549 11 15 12 17" stroke="currentColor" stroke-linecap="round"/>
    </svg>
</a>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>

<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'Copy';

        function copyingDone() {
            copybutton.innerHTML = 'Copied';
            setTimeout(() => {
                copybutton.innerHTML = 'Copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });
        codeblock.parentNode.appendChild(copybutton);
    });
</script></main>
    </body><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script>
      const images = Array.from(document.querySelectorAll(".blog-content img"));
      images.forEach(img => {
          mediumZoom(img, {
              margin: 10,  
              scrollOffset: 40,  
              container: null,  
              template: null,  
              background: 'rgba(0, 0, 0, 0.5)'
          });
      });
  </script>

  
  <script src="/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js" integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin="anonymous" defer></script></html>
